@{
    ViewBag.Title = "TestsManagement";
    Layout = "~/Views/Shared/_MainLayout.cshtml";
}
@model  AsiaLabv1.Models.TestManagementModel
@section Banner
{
    <div class="banner">

        <h2>
            <a href="index.html">Home</a>
            <i class="fa fa-angle-right"></i>
            <span>Tests Management</span>
        </h2>
    </div>
}

@*---------Start Side Navigation Menu-----------*@

@section NavMenu
{
    <li>
        <a href="@Url.Action("AdminDashboard","Main")" class=" hvr-bounce-to-right"><i class="fa fa-dashboard nav_icon "></i><span class="nav-label">Dashboard</span> </a>
    </li>

    <li>
        <a href="@Url.Action("TestsManagement", "Admin")" class=" hvr-bounce-to-right"><i class="fa fa-indent nav_icon"></i> <span class="nav-label">Tests Management</span></a>

    </li>
    <li>
        <a href="@Url.Action("Masters", "Admin")" class=" hvr-bounce-to-right"><i class="fa fa-desktop nav_icon"></i> <span class="nav-label">Masters</span></a>
    </li>

    <li>
        <a href="@Url.Action("Accounting", "Admin")" class=" hvr-bounce-to-right"><i class="fa fa-th nav_icon"></i> <span class="nav-label">Accounting</span> </a>
    </li>

    <li>
    <li>
        <a href="@Url.Action("BranchReport", "Admin")" class=" hvr-bounce-to-right"> <i class="fa fa-area-chart nav_icon"></i>Branch Report</a>
    </li>
    <li>
        <a href="@Url.Action("Register","Admin")" class=" hvr-bounce-to-right"> <i class="fa fa-area-chart nav_icon"></i>Register Employee</a>
    </li>

}
@*------------ End Side Navigation Menu----------*@


@*------------- Start Main Content Code-------------*@

<!--grid-->
<div class="typo-grid">

    <div class="typo-1">


        <div class="grid_3 grid_5">
            <h3 class="head-top">Tests Management Options</h3>
            <div class="but_list">
                <div class="bs-example bs-example-tabs" role="tabpanel" data-example-id="togglable-tabs">
                    <ul id="myTab" class="nav nav-tabs" role="tablist">
                        <li role="presentation" class="active"><a href="#home" id="home-tab" role="tab" data-toggle="tab" aria-controls="home" aria-expanded="true">Add Department</a></li>
                        <li role="presentation"><a href="#profile" role="tab" id="profile-tab" data-toggle="tab" aria-controls="profile">Add Tests</a></li>
                        <li role="presentation"><a href="#delete" role="tab" id="profile-tab" data-toggle="tab" aria-controls="delete">Delete Tests</a></li>
                        <li role="presentation"><a href="#see" role="tab" id="profile-tab" data-toggle="tab" aria-controls="see">See Tests</a></li>
                    </ul>
                    <div id="myTabContent" class="tab-content">
                        <div role="tabpanel" class="tab-pane fade in active" id="home" aria-labelledby="home-tab">
                            <div class="grid-form1">
                                @*<h4>Add Department</h4>*@
                                <div class="tab-content">

                                    <div class="tab-pane active" id="horizontal-form">

                                        <form class="form-horizontal">

                                            <br />
                                            <div class="form-group">
                                                <label for="selector1" class="col-sm-2 control-label">Select</label>
                                                <div class="col-sm-8">
                                                    
                                                    @Html.CheckBoxFor(model => model.IsNewDepartment, new { @class = "checkbox1" })
                                                    <label>Add new Department</label>
                                                    
                                                </div>
                                                
                                            </div>

                                            <div class="form-group">
                                                <label for="selector1" class="col-sm-2 control-label">Select Department</label>
                                                <div class="col-sm-8">
                                                    @Html.DropDownListFor(model => model.deptId, Model.departments, new { @class = "form-control1" })
                                                  
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label for="focusedinput" class="col-sm-2 control-label">Department Name</label>
                                                <div class="col-sm-8">
                                                    @Html.TextBoxFor(model => model.deptName, new { @class = "form-control1" })
                                                  
                                                </div>

                                            </div>

                                            <div class="form-group">
                                                <label for="focusedinput" class="col-sm-2 control-label">Sub-Department Name</label>
                                                <div class="col-sm-8">
                                                    @Html.TextBoxFor(model => model.testCategoryName, new { @class = "form-control1" })
                                                  
                                                </div>

                                            </div>

                                            @*<div class="form-group">
                                                <label for="focusedinput" class="col-sm-2 control-label">@Html.LabelFor(model => model.CatgoryCode)</label>
                                                <div class="col-sm-8">
                                                    @Html.TextBoxFor(model => model.CatgoryCode, new { @class = "form-control1" })
                                                  
                                                </div>

                                            </div>*@

                                            <div class="form-group">
                                                
                                                <div class="col-sm-8" style="margin-left:26%">
                                                    <button id="addDepbtn" class="btn btn-danger">Add</button>

                                                </div>

                                            </div>

                                          



                                            <div class="clearfix"> </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div role="tabpanel" class="tab-pane fade" id="profile" aria-labelledby="profile-tab">
                            <div class="grid-form1">
    @*----------------------------------------------------------------------------------------------------------------------------------*@
                                @*<h3>Add New Tests</h3>*@
                                <div class="tab-content">

                                    <div class="tab-pane active" id="horizontal-form">

                                        <form class="form-horizontal">
                                            <br />
                                            <div class="form-group">
                                                <label for="selector1" class="col-sm-2 control-label">Select Department</label>
                                                <div class="col-sm-8">
                                                    @Html.DropDownListFor(model => model.deptId, Model.departments, new {  @class = "form-control1", id="testdeptdropdown"   })
                                                   
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label for="selector1" class="col-sm-2 control-label">Select Sub-Department</label>
                                                <div class="col-sm-8">
                                                   
                                                    <select name="selector1" id="testcategdeptdropdown" class="form-control1"></select>
                                                    
                                                    
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="focusedinput" class="col-sm-2 control-label">Add New Test Name</label>
                                                <div class="col-sm-8">
                                                    @Html.TextBoxFor(model => model.testName, new { @class = "form-control1" })
                                                </div>

                                            </div>
                                            <div class="form-group">
                                                <label for="focusedinput" class="col-sm-2 control-label">Upper Bound</label>
                                                <div class="col-sm-8">
                                                    @Html.TextBoxFor(model => model.upperBound, new { @class = "form-control1" })
                                                </div>

                                            </div>

                                            <div class="form-group">
                                                <label for="focusedinput" class="col-sm-2 control-label">Lower Bound</label>
                                                <div class="col-sm-8">
                                                    @Html.TextBoxFor(model => model.lowerBound, new { @class = "form-control1" })
                                                </div>

                                            </div>
                                            <div class="form-group">
                                                <label for="selector1" class="col-sm-2 control-label">Select Unit</label>
                                                <div class="col-sm-8">
                                                    @Html.TextBoxFor(model => model.unit, new { @class = "form-control1" })
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label for="focusedinput" class="col-sm-2 control-label">Rate</label>
                                                <div class="col-sm-8">
                                                    @Html.TextBoxFor(model => model.rate, new { @class = "form-control1" })
                                                </div>

                                            </div>

                                            <div class="form-group">

                                                <div class="col-sm-8" style="margin-left:26%">
                                                    <button id="addTestbtn" class="btn btn-danger">Add</button>

                                                </div>

                                            </div>

                                            

                                            <div class="clearfix"> </div>
                                        </form>

                                    </div>

                                </div>

                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane fade in" id="delete" aria-labelledby="delete">
                            <div class="grid-form1">
                                @*<h3>Delete Tests</h3>*@
                                <div class="tab-content">

                                    <div class="tab-pane active" id="horizontal-form">

                                        <form class="form-horizontal">


                                            <br />

                                            <div class="form-group">
                                                <label for="selector1" class="col-sm-2 control-label">Select Department</label>
                                                <div class="col-sm-8">
                                                    @Html.DropDownListFor(model => model.deptId, Model.departments, new { @class = "form-control1", id = "testdeptdropdown2" })
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label for="selector1" class="col-sm-2 control-label">Select Test Head</label>
                                                <div class="col-sm-8">
                                                    <select name="selector1" id="testHeadDropDown" class="form-control1">
                                                      

                                                    </select>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="focusedinput" class="col-sm-2 control-label">Select Test Name</label>
                                                <div class="col-sm-8">
                                                    <select name="selector1" id="testDropDown" class="form-control1">

                                                    </select>
                                                </div>

                                            </div>
                                            <div class="form-group">

                                                <div class="col-sm-8" style="margin-left:26%">
                                                    <button id="deleteTestbtn" class="btn btn-danger">Delete</button>

                                                </div>

                                            </div>

                                            <div class="clearfix"> </div>
                                        </form>

                                    </div>

                                </div>

                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane fade in" id="see" aria-labelledby="delete">
                            <div class="grid-form1">
                                @*<h3>See Tests</h3>*@
                                <div class="tab-content">

                                    <div class="tab-pane active" id="horizontal-form">

                                        <form class="form-horizontal">


                                            <br />
                                            <div class="form-group">
                                                <label for="selector1" class="col-sm-2 control-label">Select Department</label>
                                                <div class="col-sm-8">
                                                    <select name="selector1" id="selector1" class="form-control1">
                                                        <option>Lab</option>
                                                        <option>C.T Scan</option>
                                                        <option>Ultrasound</option>
                                                        <option>X-Ray</option>
                                                    </select>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label for="selector1" class="col-sm-2 control-label">Select SubCategory</label>
                                                <div class="col-sm-8">
                                                    <select name="selector1" id="selector1" class="form-control1">
                                                        <option>Biochemistry Tests</option>
                                                        <option>Urine</option>
                                                        <option>...</option>
                                                        <option>...</option>
                                                        <option>...</option>

                                                    </select>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="selector1" class="col-sm-2 control-label">Tests</label>
                                                <div class="col-sm-8">
                                                    <select name="selector1" id="selector1" class="form-control1">
                                                        <option>...</option>
                                                        <option>...</option>
                                                        <option>...</option>
                                                        <option>...</option>
                                                        <option>...</option>

                                                    </select>
                                                </div>
                                            </div>
                                            <div class="clearfix"> </div>
                                        </form>

                                    </div>

                                </div>

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
  
    $('#testdeptdropdown').change(function () {
        
        $.ajax({
            url: '/User/Get/20',
            dataType: "json",
            type: "GET",
            contentType: 'application/json; charset=utf-8',
            async: true,
            processData: false,
            cache: false,
            success: function (data) {
                alert(data);
            },
            error: function (xhr) {
                alert('error');
            }
        });


        var vo = $("#testdeptdropdown").val();
        alert(vo);
        $.ajax({
            type: 'GET',
            url: '/Admin/AddCategories/',
            data: { id: vo },
            contentType: 'application/json',
            async: true,
            processData: false,
            cache: false,
            dataType: "json",
            success: function (data) {

                alert("successfully reached");
                //var jsonData1 = JSON.parse(data);
                alert("Data"+data);
                //var appenddata1 = "";
                //var jsonData1 = JSON.parse(data);
                //alert(jasonData1[0].testCategoryId);
                //for (var i = 0; i < jsonData1.length; i++) {
                //    appenddata1 += "<option value = '" + jsonData1[i].testCategoryId + " '>" + jsonData1[i].testCategoryName + " </option>";
                //}
                //$("#testcategdeptdropdown").append(appenddata1);
            },
            error: function (data) {
                alert("error"+data);
            }
        });
    });

    $('#addDepbtn').click(function () {
        alert("check");
            deptid = $('#deptId').val();
            deptname = $('#deptName').val();
            testcategoryName = $('#testCategoryName').val();
            IsnewDepartment = $('#IsNewDepartment').val();
            Catgorycode = $('#CatgoryCode').val();

            var obj = {
                deptId: deptid,
                deptName: deptname,
                testCategoryName: testcategoryName,
                IsNewDepartment: IsnewDepartment,
                departments: null,
                testCategoryId: -1,
                CatgoryCode: Catgorycode
            };
            alert(obj);
            $.ajax({

                type: 'POST',
                url: '/Admin/AddTestDepartmentsAndCategories/',
                data: obj,
                dataType: "json",

            });
    });








    $('#addTestbtn').click(function () {

        deptid = $('#deptId').val();
        TestCategoryId = $('#testcategdeptdropdown').val();
        TestSubcategoryName = $('#testName').val();
        UpperBound = $('#upperBound').val();
        LowerBound = $('#lowerBound').val();
        Unit = $('#unit').val();
        Rate = $('#rate').val();

        var obj = {
            deptId: deptid,
            TestCategoryId: 1,
            TestSubcategoryName: TestSubcategoryName,
            upperBound: UpperBound,
            lowerBound: LowerBound,
            Unit:Unit,
            Rate:Rate
        };

        $.ajax({

            type: 'POST',
            url: '/Admin/AddTests/',
            data: obj,
            dataType: "json",

        });
    });



    //For Deleting Tests

    $('#testdeptdropdown2').change(function () {

        var vo = $("#testdeptdropdown2").val();
        alert(vo);
        $.ajax({
            type: 'GET',
            url: '/Admin/FillDropdown/',
            data: { categId: vo, subCategId: null },
            dataType: "json",
            success: function (data) {

                alert("successfully reached");
                //var appenddata1 = "";
                //var jsonData1 = JSON.parse(data);
                //alert(jasonData1[0].testCategoryId);
                //for (var i = 0; i < jsonData1.length; i++) {
                //    appenddata1 += "<option value = '" + jsonData1[i].testCategoryId + " '>" + jsonData1[i].testCategoryName + " </option>";
                //}
                //$("#testcategdeptdropdown").append(appenddata1);
            },
            error: function (data) {
                alert(data.testcategoryName);
            }
        });
    });



    $('#testHeadDropDown').change(function () {

        var vo = $("#testHeadDropDown").val();
        alert(vo);
        $.ajax({
            type: 'GET',
            url: '/Admin/FillDropdown/',
            data: {categId: null, subCategId: vo },
            dataType: "json",
            success: function (data) {

                alert("successfully reached");
                //var appenddata1 = "";
                //var jsonData1 = JSON.parse(data);
                //alert(jasonData1[0].testCategoryId);
                //for (var i = 0; i < jsonData1.length; i++) {
                //    appenddata1 += "<option value = '" + jsonData1[i].testCategoryId + " '>" + jsonData1[i].testCategoryName + " </option>";
                //}
                //$("#testcategdeptdropdown").append(appenddata1);
            },
            error: function (data) {
                alert(data.TestSubcategoryName);
            }
        });
    });

    $('#deleteTestbtn').click(function () {
        alert("check");

        //testSubDept = $('#testHeadDropDown').val();
        //deptname = $('#testdeptdropdown2').val();
        testcategoryName = $('#testDropDown').val();

        $.ajax({

            type: 'POST',
            url: '/Admin/Delete/',
            //data: { testSubDepts: testSubDept ,deptnames:deptname,testcategoryNames:testcategoryName},
            data: { testcategoryNames: "testcategoryName" },
            dataType: "json",

        });
    });

</script>

<!--//grid-->
@*------------- End Main Content Code-------------*@

